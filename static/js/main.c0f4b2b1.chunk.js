(this["webpackJsonpmozio-sdk-partner-generator"]=this["webpackJsonpmozio-sdk-partner-generator"]||[]).push([[0],{29:function(e,t,a){e.exports=a(73)},34:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(25),l=a.n(o),i=(a(34),a(6)),c=a(7),s=a(9),u=a(8),m=a(4),d=a(10),p=a(2),g=a.n(p),h=a(26),b=a(12),f=[{name:"name",type:"text",label:"Partner Name",error:!1,background:null},{name:"code",type:"text",label:"Partner ID (unlock code)",error:!1,background:null},{name:"tint_color",type:"color",label:"Tint Color",error:!1,background:null},{name:"contrast_tint_color",type:"color",label:"Contrast Tint Color",error:!1,background:null},{name:"primary_color",type:"color",label:"Primary Color",error:!1,background:null},{name:"secondary_color",type:"color",label:"Secondary Color",error:!1,background:null},{name:"accept_color",type:"color",label:"Accept (success) Color",error:!1,background:null},{name:"error_color",type:"color",label:"Error Color",error:!1,background:null},{name:"id",type:"text",label:"Internal ID (autogenerated)",error:!1,background:null}],E={LOGO:"logo",SCREEN_IMAGE:"screenImage",SCREEN_WIDE_IMAGE:"screenWideImage",DATA:"data"},v=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={fields:f,step:E.LOGO,data:{},logoDataURL:null,logoFile:null,screenImageDataURL:null,screenImageFile:null,screenWideImageDataURL:null,screenWideImageFile:null},a.handleSubmit=a.handleSubmit.bind(Object(m.a)(a)),a.logoFileDropped=a.logoFileDropped.bind(Object(m.a)(a)),a.screenImageFileDropped=a.screenImageFileDropped.bind(Object(m.a)(a)),a.screenWideImageFileDropped=a.screenWideImageFileDropped.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"hasErrors",value:function(){console.log("Checking for errors... "+JSON.stringify(this.state.fields,null,2));var e=!0,t=!1,a=void 0;try{for(var n,r=this.state.fields[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){if(n.value.error)return!0}}catch(o){t=!0,a=o}finally{try{e||null==r.return||r.return()}finally{if(t)throw a}}return!1}},{key:"handleSubmit",value:function(e){if(e.preventDefault(),this.hasErrors())alert("Not so fast! There are some errors, please check the data...");else{var t=new FormData(e.target),a={};t.forEach((function(e,t){null!==e&&""!==e&&(a[t]=e)}));var n={logo:this.state.logoFile,screenImage:this.state.screenImageFile,screenWideImage:this.state.screenWideImageFile};this.props.onSubmit(a,n)}}},{key:"logoFileDropped",value:function(e){var t=this,a=e[0],n=new FileReader;n.onload=function(e){var n=t.state.step;t.setState({logoDataURL:e.target.result,logoFile:a,step:n===E.LOGO?E.SCREEN_IMAGE:n})},n.readAsDataURL(a)}},{key:"screenImageFileDropped",value:function(e){var t=this,a=e[0],n=new FileReader;n.onload=function(e){var n=t.state.step;t.setState({screenImageDataURL:e.target.result,screenImageFile:a,step:n===E.SCREEN_IMAGE?E.SCREEN_WIDE_IMAGE:n})},n.readAsDataURL(a)}},{key:"screenWideImageFileDropped",value:function(e){var t=this,a=e[0],n=new FileReader;n.onload=function(e){var n=t.state.step;t.setState({screenWideImageDataURL:e.target.result,screenWideImageFile:a,step:n===E.SCREEN_WIDE_IMAGE?E.DATA:n})},n.readAsDataURL(a)}},{key:"onDropInvalidFile",value:function(){alert("Now slow down! This doesn't seem to be a valid image. We only accept PNGs...")}},{key:"fieldChangeCallback",value:function(e){var t=this;return"color"===e.type?function(a){var n,r=(n=a.target.value).startsWith("#")&&7===n.length?n:n.startsWith("#")||6!==n.length?n:"#"+n,o=function(e){return/^#[0-9A-F]{6}$/i.test(e)}(r);t.setFieldBackgroundColor(e,o?r:null,(function(){t.setFieldErrorState(e,!o&&""!==r,(function(){t.setState({data:Object.assign({},t.state.data,Object(h.a)({},e.name,r))})}))}))}:"name"===e.name?function(e){var a=e.target.value;if(""!==a){var n=a.replace(/\s+/g,"").toLowerCase();t.setState({data:Object.assign({},t.state.data,{id:n,code:n+Math.floor(8999*Math.random()+1e3)})})}}:function(e){}}},{key:"setFieldBackgroundColor",value:function(e,t,a){console.log("Setting "+e.name+" background color to "+t),this.setState({fields:this.state.fields.map((function(a){return a.name===e.name?Object.assign({},a,{background:t}):a}))},a)}},{key:"setFieldErrorState",value:function(e,t,a){this.setState({fields:this.state.fields.map((function(a){return a.name===e.name?Object.assign({},a,{error:t}):a}))},a)}},{key:"render",value:function(){var e=this,t=[r.a.createElement(b.a,{key:"logoPicker",accept:["image/png"],multiple:!1,onDropAccepted:this.logoFileDropped,onDropRejected:this.onDropInvalidFile},(function(t){var a=t.getRootProps,n=t.getInputProps;return r.a.createElement("section",null,r.a.createElement("div",a(),r.a.createElement("input",n()),r.a.createElement("p",null,"Drop the partner LOGO here (or click to select file)",e.state.logoDataURL&&r.a.createElement("img",{className:"logo",src:e.state.logoDataURL}))))})),r.a.createElement(b.a,{key:"screenImagePicker",accept:["image/png"],multiple:!1,onDropAccepted:this.screenImageFileDropped,onDropRejected:this.onDropInvalidFile},(function(t){var a=t.getRootProps,n=t.getInputProps;return r.a.createElement("section",null,r.a.createElement("div",a(),r.a.createElement("input",n()),r.a.createElement("p",null,"Drop the NARROW SCREEN IMAGE here (or click to select file)",e.state.screenImageDataURL&&r.a.createElement("img",{className:"screen-image",src:e.state.screenImageDataURL}))))})),r.a.createElement(b.a,{key:"screenWideImagePicker",accept:["image/png","image/jpeg"],multiple:!1,onDropAccepted:this.screenWideImageFileDropped,onDropRejected:this.onDropInvalidFile},(function(t){var a=t.getRootProps,n=t.getInputProps;return r.a.createElement("section",null,r.a.createElement("div",a(),r.a.createElement("input",n()),r.a.createElement("p",null,"Drop the WIDE SCREEN IMAGE here (or click to select file)",e.state.screenWideImageDataURL&&r.a.createElement("img",{className:"screen-image",src:e.state.screenWideImageDataURL}))))})),this.state.fields.map((function(t,a){console.log("Background: "+t.background);var n={backgroundColor:t.background};return t.error&&(n.borderBottom="thick solid #FF0000"),r.a.createElement(r.a.Fragment,{key:t.name},r.a.createElement("label",null,t.label,r.a.createElement("input",{name:t.name,type:"text",value:e.state.data[t.name],onChange:e.fieldChangeCallback(t),style:n})))})),r.a.createElement("button",{type:"submit"},"Submit demo!")];return r.a.createElement("form",{onSubmit:this.handleSubmit},function(){switch(e.state.step){case E.LOGO:return t.slice(0,1);case E.SCREEN_IMAGE:return t.slice(0,2);case E.SCREEN_WIDE_IMAGE:return t.slice(0,3);case E.DATA:return t}}())}}]),t}(n.Component),k=function(){function e(){Object(i.a)(this,e)}return Object(c.a)(e,[{key:"readFileAsBas64String",value:function(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){var e=n.result.toString().replace(/^data:(.*,)?/,"");e.length%4>0&&(e+="=".repeat(4-e.length%4)),t(e)},n.onerror=function(e){return a(e)}}))}}]),e}(),y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).utils=new k,a.state={partners:[],loading:!1},a.onSubmit=a.onSubmit.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getJsonPartners",value:function(){var e,t;return g.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,g.a.awrap(fetch("https://raw.githubusercontent.com/mozioinc/sdk_demos/master/demos.json"));case 2:return e=a.sent,a.next=5,g.a.awrap(e.text());case 5:return t=a.sent,console.log(e),a.abrupt("return",JSON.parse(atob(t)));case 8:case"end":return a.stop()}}))}},{key:"componentDidMount",value:function(){var e=this;this.getJsonPartners().then((function(t){console.log(t),e.setState({partners:t})}))}},{key:"onSubmit",value:function(e,t){var a=this;if(this.validateOrAbort(e)){window.scrollTo(0,0),this.setState({loading:!0});var n=this.props.github.getRepo("mozioinc","sdk_demos"),r="demo-"+e.id,o="logo_"+e.id+".png",l=e.id+"_narrow.png",i=e.id+"_wide.png";n.createBranch("master",r).then((function(){var l;return g.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,g.a.awrap(a.utils.readFileAsBas64String(t.logo));case 2:return l=i.sent,i.next=5,g.a.awrap(n.writeFile(r,"images/"+o,l,"Add "+e.name+" demo logo",{encode:!1}));case 5:return i.abrupt("return",n);case 6:case"end":return i.stop()}}))})).then((function(n){var o;return g.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,g.a.awrap(a.utils.readFileAsBas64String(t.screenImage));case 2:return o=i.sent,i.next=5,g.a.awrap(n.writeFile(r,"images/"+l,o,"Add "+e.name+" demo screen image",{encode:!1}));case 5:return i.abrupt("return",n);case 6:case"end":return i.stop()}}))})).then((function(n){var o;return g.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,g.a.awrap(a.utils.readFileAsBas64String(t.screenWideImage));case 2:return o=l.sent,l.next=5,g.a.awrap(n.writeFile(r,"images/"+i,o,"Add "+e.name+" demo screen wide image",{encode:!1}));case 5:return l.abrupt("return",n);case 6:case"end":return l.stop()}}))})).then((function(t){var n,c,s;return g.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return"{branch_name}",e.logo_url="https://raw.githubusercontent.com/mozioinc/sdk_demos/{branch_name}/images/"+o,e.screen_image_url="https://raw.githubusercontent.com/mozioinc/sdk_demos/{branch_name}/images/"+l,e.screen_wide_image_url="https://raw.githubusercontent.com/mozioinc/sdk_demos/{branch_name}/images/"+i,n=!1,c=a.state.partners.map((function(t){return t.id===e.id?(n=!0,e):t})),n||c.push(e),s=btoa(JSON.stringify(c)),u.next=10,g.a.awrap(t.writeFile(r,"demos.json",s,"Add "+e.name+" to demos JSON",{encode:!0}));case 10:return u.abrupt("return",t);case 11:case"end":return u.stop()}}))})).then((function(t){return t.createPullRequest({title:e.name,head:r,base:"master",body:"Adds all necessary files for the "+e.name+" demo: \n```\n"+JSON.stringify(e,null,2)+"\n```"})})).then((function(e){alert("Success!"),a.setState({loading:!1})}),(function(e){return alert("Error... "+e),a.setState({loading:!1}),n.deleteRef("heads/"+r).then((function(){}),(function(e){alert("Could not delete the branch. It probably failed before a new branch was created: "+e)}))}))}}},{key:"validateOrAbort",value:function(e){return e.id&&""!==e.id?e.tint_color&&""!==e.tint_color?e.contrast_tint_color&&""!==e.contrast_tint_color?!(!e.primary_color||""===e.primary_color)||(alert("Please fill in the primary color!"),!1):(alert("Please fill in the contrast tint color!"),!1):(alert("Please fill in the tint color!"),!1):(alert("Please fill in the ID!"),!1)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:"column"},this.state.partners.map((function(e){return r.a.createElement("li",{key:e.id},r.a.createElement("p",null,e.name),r.a.createElement("img",{className:"partner-logo",src:e.logo_url,alt:e.name}))}))),this.state.loading||r.a.createElement("div",{className:"column form"},r.a.createElement(v,{onSubmit:this.onSubmit})),this.state.loading&&r.a.createElement("p",null,"Saving..."))}}]),t}(n.Component),D=a(28),I=a.n(D),S=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={},a.handleSubmit=a.handleSubmit.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=new FormData(e.target),a={};t.forEach((function(e,t){a[t]=e}));var n=new I.a({username:a.username,password:a.access_token});this.props.onLogin(n)}},{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("label",null,"Github username",r.a.createElement("input",{name:"username",type:"text"})),r.a.createElement("label",null,"Github access token",r.a.createElement("input",{name:"access_token",type:"password"})),r.a.createElement("p",null,"Create one here: ",r.a.createElement("a",{href:"https://github.com/settings/tokens",target:"_blank",rel:"noopener noreferrer"}," https://github.com/settings/tokens ")),r.a.createElement("p",null,"ONLY give access to ",r.a.createElement("b",null,"public_repo")),r.a.createElement("button",{type:"submit"},"Proceed"))}}]),t}(n.Component),w=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={github:null},a.handleLogin=a.handleLogin.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleLogin",value:function(e){this.setState({github:e})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,null!=this.state.github||r.a.createElement(S,{onLogin:this.handleLogin}),this.state.github&&r.a.createElement(y,{github:this.state.github}))}}]),t}(n.Component);var O=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"SDK Partnerator 3000"),r.a.createElement(w,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[29,1,2]]]);
//# sourceMappingURL=main.c0f4b2b1.chunk.js.map